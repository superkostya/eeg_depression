# Predicting Depression with EEG

#### Author: Kostyantyn Borysenko, PhD

## Goal: Predict a depression, based on person's EEG and demographics

## Data

### Initial Dataset

 * The provided dataset (`EEG_dataset.csv`) contains the EEG results for 110 patients, 2 sessions each. 
     * The EEG data consists of the recorded signals for multiple frequency bands (labelled by greek letters: "alpha" through "omega")
     * Each frequency band has been recorded for 5 channels
 * Additionally, some demographic data is included:
     * Age
     * Health history
     * Whether or not a subject had had a follow-up appointment with a psychiatrist.

### Feature Engineering

 * Clean the "Age" column and extract the numerical age (years)
 * Convert a string with list of pre-existing health conditions into a group of binary features, where each feature represents presence/absence of a given condition.
 * Convert the "follow-up appointment" column into a numeric binary feature
 * Create the target column (`has_depression`). __Note:__ A quick estimate shows that the dataset is quite well-balanced: Approximately 58% of all subjects/sessions listed "depression" as one of pre-existing health conditions. This means that we don't have to be concerned with issues caused by datasets with unbalanced classes.
 * However, a small size of the dataset (220 records) suugests that we may have some issues evaluating the trained model's performance. To that end, we will employ one of well-established techniques, such as k-fold cross-validation.
 
## Selecting & Evaluating a Predictive Model

 * The problem of predicting a presence of a certain health condition naturally lands itself with the class of machine learning models known as binary classifiers.
 * We explore several popular models, and compare their performance:
     * Support Vector Classifier (with several different kernels)
     * Random Forest
     * AdaBoost
 * As a metric to estimate a model's performance, we use the F1 score that should give us a better understanding of a balance between precision and recall. In further studies, we could utilize a modification known as a $F_{\beta}$ score, which allows emphasizing precision or recall during the model evaluation, when the costs of a false positive and false negative differ considerably.
 * In the comparative analysis, the ensemble learners (random forest, and a boosting algorithm "AdaBoost") scored the highest: both acheved the score F1 = 1 on a 5-fold cross-validation experiment.
 
## Brief Exploration of the Feature Importance

 * In order to gain some insight into which features are the most valuable when attempting to predict depression, we try two approaches:
     * Random Forest feature importance
     * SHAP score
 * We found that in this case, the feature importance scores generated by the random forest model were of limited value: too many features had similar importance values. besides, these scores provide very little help when trying to interpret the results of a single prediction.
 * Using the SHAP score proves to be a bit nore informative:
     * We can see that some demographic information is high on the list of things that may cause depression:
         * Age
         * A follow-up appointment with a psychiatrist
         * Some other pre-existing conditions (e.g., multiple sclerosis, alcohol)
     * We also see that some EEG frequency bands stand out and thus, could be more strongly correlated with depression. Thus, the feature 'omega_Channel_2' scored the highest among other EEG channels.
     
## Conclusions

 * The ensemble learners proved to be the most accurate models to predict depression based on the EEG results, accompanied by some demographic data.
 * SHAP score helps analyze the relative importance of different features, which helps explain every given prediction. A further study is necessary in order to gain more clarity on which EEG frequency bands correlate more strongly with the depression.

## References and Citations

 * [Greek Alphabet Soup â€“ Making Sense of EEG Bands](http://neurosky.com/2015/05/greek-alphabet-soup-making-sense-of-eeg-bands/#:~:text=In%20the%20figure%20to%20the,%2C%20alpha%2C%20beta%20and%20gamma.)
 
 * [5 Types Of Brain Waves Frequencies: Gamma, Beta, Alpha, Theta, Delta](https://mentalhealthdaily.com/2014/04/15/5-types-of-brain-waves-frequencies-gamma-beta-alpha-theta-delta/)